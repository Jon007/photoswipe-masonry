jQuery(function(t){photoswipe_masonry(t)});var photoswipe_masonry=function(t){var e=t(".pswp")[0],i=t(".psgal").first();$galleryUID=i.attr("id"),void 0===$galleryUID&&(i.attr("id","psgalmain"),$galleryUID="psgalmain"),getItems=function(){var e=[];return i.find("a").each(function(){var i=t(this).find("img").first();if(i.length){var a=t(this).attr("href");if(!a)return;switch(a.split(".").pop().toLowerCase()){case"jpg":case"png":case"jpeg":var r=1800,n=1800,s=t(this).attr("data-size");if(s)(s=s.split("x")).length>1&&(r=s[0],n=s[1]);else{var l=i.attr("width"),h=i.attr("height");try{n=r*h/l}catch(t){}}if(t(this).attr("data-psindex",e.length),$title=t(this).attr("data-caption"),!$title){try{$figure=t(this).parent(),$parentTag=$figure[0].tagName,"FIGURE"==$parentTag&&($figcaption=t(this).parent().find("figcaption"),$figcaption[0]&&($title=$figcaption[0].textContent))}catch(t){}$title||($title=i.attr("title"),$title||($title=i.attr("alt"),$title||($title=a.substring(a.lastIndexOf("/")+1))))}var p={src:a,w:r,h:n,el:t(this),msrc:i.attr("src"),title:$title};e.push(p)}}}),i&&i[0].classList.contains("bbpress")&&t(".bbp-body").first().find("img").each(function(){var i=t(this),a=i.parent();if("A"!=a[0].tagName.toUpperCase()&&!i[0].classList.contains("avatar")){$href=i.attr("src");var r=1800,n=i.attr("width"),s=i.attr("height");try{r=1800*s/n}catch(t){}var l=i.attr("title");l||(l=i.attr("alt"))||(l=$href.substring($href.lastIndexOf("/")+1));var h=document.createElement("a");h.setAttribute("href",$href),h.setAttribute("data-psindex",e.length),a[0].replaceChild(h,i[0]),h.appendChild(i[0]);var p={src:$href,w:1800,h:r,el:t(h),msrc:$href,title:l};e.push(p)}}),e};var a=getItems();i.on("click","a[data-psindex]",function(i){i.preventDefault();var r=0;try{r=Number(t(this).attr("data-psindex"))}catch(t){}var n={index:r,bgOpacity:.9,showHideOpacity:!1,galleryUID:$galleryUID,getThumbBoundsFn:function(t){var e=a[t].el.find("img"),i=e.offset();return{x:i.left,y:i.top,w:e.width()}}};new PhotoSwipe(e,PhotoSwipeUI_Default,a,n).init()});var r=parseHash();r.gid&&t("#"+r.gid).each(function(){$index=Number(r.pid);var t={index:$index,bgOpacity:.9,showHideOpacity:!1,galleryUID:r.gid,getThumbBoundsFn:function(t){var e=a[t].el.find("img"),i=e.offset();return{x:i.left,y:i.top,w:e.width()}}};new PhotoSwipe(e,PhotoSwipeUI_Default,a,t).init()})},parseHash=function(){var t=window.location.hash.substring(1),e={};if(t.length<5)return e;for(var i=t.split("&"),a=0;a<i.length;a++)if(i[a]){var r=i[a].split("=");r.length<2||(e[r[0]]=r[1])}return e.pid=parseInt(e.pid,10),e};