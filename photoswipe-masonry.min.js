jQuery(function(t){photoswipe_masonry(t)});var photoswipe_masonry=function(p){var e=p(".pswp")[0],t=p(".psgal").first();$galleryUID=t.attr("id"),void 0===$galleryUID&&(t.attr("id","psgalmain"),$galleryUID="psgalmain"),getItems=function(){var h=[];(t.find("a").each(function(){var t=p(this).find("img").first();if(t.length){var a=p(this).attr("href");if(!a)return;switch(a.split(".").pop().toLowerCase()){case"jpg":case"png":case"jpeg":var i=1800,e=1800,r=p(this).attr("data-size");if(r?1<(r=r.split("x")).length&&(i=r[0],e=r[1]):(i=myImg.naturalWidth,e=myImg.naturalHeight,p(this).attr("data-size",i+"x"+e)),p(this).attr("data-psindex",h.length),$title=p(this).attr("data-caption"),!$title){try{$figure=p(this).parent(),$parentTag=$figure[0].tagName,"FIGURE"==$parentTag&&($figcaption=p(this).parent().find("figcaption"),$figcaption[0]&&($title=$figcaption[0].textContent))}catch(t){}$title||($title=t.attr("title"),$title||($title=t.attr("alt"),$title||($title=a.substring(a.lastIndexOf("/")+1))))}var n={src:a,w:i,h:e,el:p(this),msrc:t.attr("src"),title:$title};h.push(n)}}}),t&&t[0].classList.contains("bbpress"))&&p(".bbp-body").first().find("img").each(function(){var t=p(this),a=t.parent();if("A"!=a[0].tagName.toUpperCase()&&!t[0].classList.contains("avatar")){$href=t.attr("src");var i=1800,e=t.attr("width"),r=t.attr("height");try{i=1800*r/e}catch(t){}var n=t.attr("title");n||(n=t.attr("alt"))||(n=$href.substring($href.lastIndexOf("/")+1));var s=document.createElement("a");s.setAttribute("href",$href),s.setAttribute("data-psindex",h.length),a[0].replaceChild(s,t[0]),s.appendChild(t[0]);var l={src:$href,w:1800,h:i,el:p(s),msrc:$href,title:n};h.push(l)}});return h};var r=getItems();t.on("click","a[data-psindex]",function(t){t.preventDefault();var a=0;try{a=Number(p(this).attr("data-psindex"))}catch(t){}var i={index:a,bgOpacity:.9,showHideOpacity:!1,galleryUID:$galleryUID,getThumbBoundsFn:function(t){var a=r[t].el.find("img"),i=a.offset();return{x:i.left,y:i.top,w:a.width()}}};new PhotoSwipe(e,PhotoSwipeUI_Default,r,i).init()});var a=parseHash();a.gid&&p("#"+a.gid).each(function(){$index=Number(a.pid);var t={index:$index,bgOpacity:.9,showHideOpacity:!1,galleryUID:a.gid,getThumbBoundsFn:function(t){var a=r[t].el.find("img"),i=a.offset();return{x:i.left,y:i.top,w:a.width()}}};new PhotoSwipe(e,PhotoSwipeUI_Default,r,t).init()})},parseHash=function(){var t=window.location.hash.substring(1),a={};if(t.length<5)return a;for(var i=t.split("&"),e=0;e<i.length;e++)if(i[e]){var r=i[e].split("=");r.length<2||(a[r[0]]=r[1])}return a.pid=parseInt(a.pid,10),a};