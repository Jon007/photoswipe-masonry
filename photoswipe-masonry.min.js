jQuery(function(t){photoswipe_masonry(t)});var photoswipe_masonry=function(c){var i=c(".pswp")[0],t=c(".psgal").first();$galleryUID=t.attr("id"),void 0===$galleryUID&&(t.attr("id","psgalmain"),$galleryUID="psgalmain"),getItems=function(){var l=[];(t.find("a").each(function(){var t=c(this).find("img").first();if(t.length){var e=c(this).attr("href");if(!e)return;switch(e.split(".").pop().toLowerCase()){case"jpg":case"png":case"jpeg":var a=1800,i=1800,r=c(this).attr("data-size");if(r)1<(r=r.split("x")).length&&(a=r[0],i=r[1]);else{var n=t.attr("width"),s=t.attr("height");try{i=a*s/n}catch(t){}}if(c(this).attr("data-psindex",l.length),$title=c(this).attr("data-caption"),!$title){try{$figure=c(this).parent(),$parentTag=$figure[0].tagName,"FIGURE"==$parentTag&&($figcaption=c(this).parent().find("figcaption"),$figcaption[0]&&($title=$figcaption[0].textContent))}catch(t){}$title||($title=t.attr("title"),$title||($title=t.attr("alt"),$title||($title=e.substring(e.lastIndexOf("/")+1))))}var h={src:e,w:a,h:i,el:c(this),msrc:t.attr("src"),title:$title};l.push(h)}}}),t&&t[0].classList.contains("bbpress"))&&c(".bbp-body").first().find("img").each(function(){var t=c(this),e=t.parent();if("A"!=e[0].tagName.toUpperCase()&&!t[0].classList.contains("avatar")){$href=t.attr("src");var a=1800,i=t.attr("width"),r=t.attr("height");try{a=1800*r/i}catch(t){}var n=t.attr("title");n||(n=t.attr("alt"))||(n=$href.substring($href.lastIndexOf("/")+1));var s=document.createElement("a");s.setAttribute("href",$href),s.setAttribute("data-psindex",l.length),e[0].replaceChild(s,t[0]),s.appendChild(t[0]);var h={src:$href,w:1800,h:a,el:c(s),msrc:$href,title:n};l.push(h)}});t&&t[0].classList.contains("single-ai1ec_event")&&c(".entry-content").first().find("img").each(function(){var t=c(this),e=t.parent();if("A"!=e[0].tagName.toUpperCase()&&!t[0].classList.contains("avatar")){$href=t.attr("src");var a=1800,i=t.attr("width"),r=t.attr("height");try{a=1800*r/i}catch(t){}var n=t.attr("title");n||(n=t.attr("alt"))||(n=$href.substring($href.lastIndexOf("/")+1));var s=document.createElement("a");s.setAttribute("href",$href),s.setAttribute("data-psindex",l.length),e[0].replaceChild(s,t[0]),s.appendChild(t[0]);var h={src:$href,w:1800,h:a,el:c(s),msrc:$href,title:n};l.push(h)}});return l};var r=getItems();t.on("click","a[data-psindex]",function(t){t.preventDefault();var e=0;try{e=Number(c(this).attr("data-psindex"))}catch(t){}var a={index:e,bgOpacity:.9,showHideOpacity:!1,galleryUID:$galleryUID,getThumbBoundsFn:function(t){var e=r[t].el.find("img"),a=e.offset();return{x:a.left,y:a.top,w:e.width()}}};new PhotoSwipe(i,PhotoSwipeUI_Default,r,a).init()});var e=parseHash();e.gid&&c("#"+e.gid).each(function(){$index=Number(e.pid);var t={index:$index,bgOpacity:.9,showHideOpacity:!1,galleryUID:e.gid,getThumbBoundsFn:function(t){var e=r[t].el.find("img"),a=e.offset();return{x:a.left,y:a.top,w:e.width()}}};new PhotoSwipe(i,PhotoSwipeUI_Default,r,t).init()})},parseHash=function(){var t=window.location.hash.substring(1),e={};if(t.length<5)return e;for(var a=t.split("&"),i=0;i<a.length;i++)if(a[i]){var r=a[i].split("=");r.length<2||(e[r[0]]=r[1])}return e.pid=parseInt(e.pid,10),e};